@startuml
' =========================
' Controllers & dependencies
' =========================
skinparam classAttributeIconSize 0

package "Controllers" {
  class AuthController {
    +register(req,res)
    +login(req,res)
  }

  class BookingController {
    +createBooking(req,res)
    +getMyBookings(req,res)
    +cancelBooking(req,res)
    +getOwnerBookings(req,res)
  }

  class CampiController {
    +getCampiByStruttura(req,res)
  }

  class OwnerController {
    +createStruttura(req,res)
    +getMyStrutture(req,res)
    +updateStruttura(req,res)
    +getOwnerBookings(req,res)
  }

  class StruttureController {
    +getStrutture(req,res)
    +getStrutturaById(req,res)
    +getCampiByStruttura(req,res)
    +getOwnerStrutture(req,res)
  }
}

package "Models (Mongoose)" {
  class User
  class Struttura
  class Campo
  class Booking
}

package "Middleware" {
  class AuthMiddleware {
    +AuthRequest.user
  }
}

AuthController ..> User : findOne/create
BookingController ..> Booking : CRUD + populate
BookingController ..> Campo : validate/lookup
BookingController ..> AuthMiddleware : AuthRequest

CampiController ..> Campo : find

OwnerController ..> Struttura : create/find/update
OwnerController ..> Booking : find (owner bookings)
OwnerController ..> AuthMiddleware : AuthRequest

StruttureController ..> Struttura : find/findById
StruttureController ..> Campo : find
StruttureController ..> AuthMiddleware : AuthRequest (owner endpoints)

@enduml
